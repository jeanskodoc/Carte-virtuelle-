<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Système de Paiement Sécurisé</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/qrcode@1.5.3/build/qrcode.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/jsqr@1.4.0/dist/jsQR.js"></script>
    <style>
        :root {
            --primary: #3a86ff;
            --secondary: #8338ec;
            --success: #06d6a0;
            --danger: #ef476f;
            --warning: #ffd166;
            --dark: #1a1a2e;
            --light: #f8f9fa;
            --gray: #6c757d;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            color: var(--light);
            min-height: 100vh;
            padding: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .login-container {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 15px;
            padding: 40px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            width: 100%;
            max-width: 400px;
            text-align: center;
        }
        
        .logo {
            font-size: 32px;
            font-weight: bold;
            color: var(--light);
            margin-bottom: 20px;
        }
        
        .logo span {
            color: var(--primary);
        }
        
        .login-form {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }
        
        .form-group {
            text-align: left;
        }
        
        label {
            display: block;
            margin-bottom: 8px;
            font-size: 14px;
        }
        
        input, select, textarea {
            width: 100%;
            padding: 12px 15px;
            border-radius: 10px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            background: rgba(255, 255, 255, 0.05);
            color: white;
            font-size: 16px;
        }
        
        input:focus, select:focus, textarea:focus {
            outline: none;
            border-color: var(--primary);
        }
        
        .btn {
            padding: 12px 20px;
            border: none;
            border-radius: 10px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }
        
        .btn-primary {
            background: var(--primary);
            color: white;
        }
        
        .btn-secondary {
            background: rgba(255, 255, 255, 0.1);
            color: white;
        }
        
        .btn-success {
            background: var(--success);
            color: white;
        }
        
        .btn-whatsapp {
            background: #25D366;
            color: white;
        }
        
        .btn-warning {
            background: var(--warning);
            color: var(--dark);
        }
        
        .btn-info {
            background: var(--primary);
            color: white;
        }
        
        .btn-mobile-money {
            background: linear-gradient(135deg, #FF6B6B 0%, #FF8E53 100%);
            color: white;
        }
        
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }
        
        .login-options {
            display: flex;
            justify-content: space-between;
            margin-top: 15px;
            font-size: 14px;
        }
        
        .login-options a {
            color: var(--primary);
            text-decoration: none;
        }
        
        .error-message {
            color: var(--danger);
            margin-top: 10px;
            font-size: 14px;
            display: none;
        }
        
        /* Styles pour l'application principale */
        .container {
            max-width: 1200px;
            margin: 0 auto;
            width: 100%;
            display: none; /* Caché jusqu'à l'authentification */
        }
        
        header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px 0;
            margin-bottom: 30px;
        }
        
        .user-info {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .balance {
            background: rgba(255, 255, 255, 0.1);
            padding: 10px 20px;
            border-radius: 20px;
            font-weight: bold;
        }
        
        .avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: var(--primary);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            cursor: pointer;
        }
        
        .main-content {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
        }
        
        @media (max-width: 768px) {
            .main-content {
                grid-template-columns: 1fr;
            }
        }
        
        .card-section {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
        }
        
        .section-title {
            font-size: 20px;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .virtual-card {
            background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
            border-radius: 15px;
            padding: 25px;
            color: white;
            position: relative;
            overflow: hidden;
            margin-bottom: 20px;
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.2);
        }
        
        .card-chip {
            width: 50px;
            height: 40px;
            background: rgba(255, 255, 255, 0.3);
            border-radius: 8px;
            margin-bottom: 20px;
        }
        
        .card-number {
            font-size: 22px;
            letter-spacing: 2px;
            margin-bottom: 20px;
            font-family: 'Courier New', monospace;
        }
        
        .card-details {
            display: flex;
            justify-content: space-between;
        }
        
        .card-holder, .card-expiry {
            font-size: 14px;
        }
        
        .card-label {
            font-size: 12px;
            opacity: 0.8;
        }
        
        .card-logo {
            position: absolute;
            top: 25px;
            right: 25px;
            font-size: 24px;
            font-weight: bold;
        }
        
        .card-back {
            background: linear-gradient(135deg, #2d3047 0%, #1a1a2e 100%);
            border-radius: 15px;
            padding: 25px;
            color: white;
            position: relative;
            overflow: hidden;
            margin-top: 20px;
        }
        
        .card-strip {
            background: #000;
            height: 40px;
            margin: 0 -25px;
            margin-bottom: 20px;
        }
        
        .card-cvv {
            background: white;
            color: #000;
            padding: 5px 10px;
            border-radius: 5px;
            width: 60px;
            text-align: center;
            font-family: 'Courier New', monospace;
        }
        
        .actions {
            display: flex;
            gap: 15px;
            margin-top: 20px;
            flex-wrap: wrap;
        }
        
        .currency-converter {
            display: flex;
            gap: 10px;
            align-items: center;
            margin-top: 10px;
        }
        
        .currency-converter input {
            flex: 1;
        }
        
        .currency-converter span {
            font-size: 18px;
            opacity: 0.7;
        }
        
        .conversion-result {
            background: rgba(255, 255, 255, 0.05);
            padding: 10px 15px;
            border-radius: 10px;
            margin-top: 10px;
            font-size: 14px;
            display: none;
        }
        
        .fee-info {
            background: rgba(255, 193, 7, 0.1);
            border-left: 4px solid var(--warning);
            padding: 10px 15px;
            margin-top: 10px;
            border-radius: 0 8px 8px 0;
            font-size: 14px;
        }
        
        .transaction-history {
            max-height: 400px;
            overflow-y: auto;
        }
        
        .transaction-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .transaction-info {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .transaction-icon {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
        }
        
        .send {
            background: rgba(239, 71, 111, 0.2);
            color: var(--danger);
        }
        
        .receive {
            background: rgba(6, 214, 160, 0.2);
            color: var(--success);
        }
        
        .load {
            background: rgba(58, 134, 255, 0.2);
            color: var(--primary);
        }
        
        .mobile-money {
            background: rgba(255, 107, 107, 0.2);
            color: #FF6B6B;
        }
        
        .transaction-details h4 {
            font-size: 16px;
            margin-bottom: 5px;
        }
        
        .transaction-details p {
            font-size: 12px;
            opacity: 0.7;
        }
        
        .transaction-amount {
            font-weight: bold;
            font-size: 18px;
        }
        
        .negative {
            color: var(--danger);
        }
        
        .positive {
            color: var(--success);
        }
        
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }
        
        .modal-content {
            background: #1a1a2e;
            border-radius: 15px;
            padding: 30px;
            width: 90%;
            max-width: 500px;
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.3);
            max-height: 90vh;
            overflow-y: auto;
        }
        
        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }
        
        .close-modal {
            background: none;
            border: none;
            color: white;
            font-size: 24px;
            cursor: pointer;
        }
        
        .tabs {
            display: flex;
            margin-bottom: 20px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .tab {
            padding: 10px 20px;
            cursor: pointer;
            opacity: 0.7;
            transition: all 0.3s ease;
        }
        
        .tab.active {
            opacity: 1;
            border-bottom: 2px solid var(--primary);
        }
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
        }
        
        .security-features {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-top: 20px;
        }
        
        .security-item {
            background: rgba(255, 255, 255, 0.05);
            padding: 15px;
            border-radius: 10px;
            text-align: center;
        }
        
        .security-icon {
            font-size: 24px;
            margin-bottom: 10px;
            color: var(--primary);
        }
        
        footer {
            text-align: center;
            margin-top: 50px;
            padding: 20px;
            font-size: 14px;
            opacity: 0.7;
        }
        
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 15px 20px;
            border-radius: 10px;
            background: var(--success);
            color: white;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
            z-index: 1100;
            display: none;
        }
        
        .qr-code-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            margin: 20px 0;
        }
        
        #qrcode, #receive-qrcode, #scanner-container {
            background: white;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 15px;
        }
        
        #scanner-container {
            position: relative;
            width: 100%;
            max-width: 300px;
            height: 300px;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-direction: column;
        }
        
        #scanner-video {
            width: 100%;
            height: 100%;
            border-radius: 10px;
            display: none;
        }
        
        .scanner-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            border: 2px solid var(--primary);
            border-radius: 10px;
            pointer-events: none;
        }
        
        .scanner-line {
            position: absolute;
            width: 100%;
            height: 2px;
            background: var(--primary);
            animation: scan 2s infinite linear;
        }
        
        @keyframes scan {
            0% { top: 0; }
            50% { top: 100%; }
            100% { top: 0; }
        }
        
        .file-upload {
            position: relative;
            overflow: hidden;
            display: inline-block;
            width: 100%;
        }
        
        .file-upload-btn {
            background: var(--primary);
            color: white;
            padding: 12px 20px;
            border-radius: 10px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            transition: all 0.3s ease;
        }
        
        .file-upload input[type="file"] {
            position: absolute;
            left: 0;
            top: 0;
            opacity: 0;
            width: 100%;
            height: 100%;
            cursor: pointer;
        }
        
        .summary {
            background: rgba(255, 255, 255, 0.05);
            padding: 15px;
            border-radius: 10px;
            margin-top: 15px;
        }
        
        .summary-item {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
        }
        
        .summary-total {
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            padding-top: 10px;
            font-weight: bold;
            font-size: 18px;
        }
        
        .scanner-actions {
            display: flex;
            gap: 10px;
            margin-top: 15px;
            width: 100%;
        }
        
        .scanner-actions .btn {
            flex: 1;
        }
        
        .import-result {
            background: rgba(255, 255, 255, 0.05);
            padding: 15px;
            border-radius: 10px;
            margin-top: 15px;
            display: none;
        }
        
        .import-result.success {
            border-left: 4px solid var(--success);
        }
        
        .import-result.error {
            border-left: 4px solid var(--danger);
        }
        
        .transaction-preview {
            background: rgba(255, 255, 255, 0.05);
            padding: 15px;
            border-radius: 10px;
            margin-top: 15px;
            display: none;
        }
        
        .beneficiary-info {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }
        
        @media (max-width: 480px) {
            .beneficiary-info {
                grid-template-columns: 1fr;
            }
        }
        
        .auto-generate-notice {
            background: rgba(58, 134, 255, 0.1);
            border-left: 4px solid var(--primary);
            padding: 10px 15px;
            margin-top: 10px;
            border-radius: 0 8px 8px 0;
            font-size: 14px;
        }
        
        .qr-actions {
            display: flex;
            gap: 10px;
            width: 100%;
            justify-content: center;
            margin-top: 10px;
        }
        
        .qr-actions .btn {
            flex: 1;
        }
        
        .send-actions {
            display: flex;
            gap: 10px;
            margin-top: 20px;
        }
        
        .send-actions .btn {
            flex: 1;
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-top: 20px;
        }
        
        .stat-card {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 10px;
            padding: 15px;
            text-align: center;
        }
        
        .stat-value {
            font-size: 24px;
            font-weight: bold;
            margin: 10px 0;
        }
        
        .stat-label {
            font-size: 14px;
            opacity: 0.7;
        }
        
        .mobile-money-options {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }
        
        .mobile-money-option {
            flex: 1;
            text-align: center;
            padding: 15px;
            border-radius: 10px;
            background: rgba(255, 255, 255, 0.05);
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .mobile-money-option.active {
            background: rgba(255, 107, 107, 0.2);
            border: 1px solid #FF6B6B;
        }
        
        .mobile-money-option img {
            width: 40px;
            height: 40px;
            margin-bottom: 10px;
        }
        
        .load-actions {
            display: flex;
            gap: 10px;
            margin-top: 20px;
        }
        
        .load-actions .btn {
            flex: 1;
        }
        
        .user-menu {
            position: relative;
        }
        
        .dropdown-menu {
            position: absolute;
            top: 50px;
            right: 0;
            background: rgba(26, 26, 46, 0.95);
            border-radius: 10px;
            padding: 10px 0;
            min-width: 150px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
            display: none;
            z-index: 100;
        }
        
        .dropdown-item {
            padding: 10px 15px;
            cursor: pointer;
            transition: background 0.3s;
        }
        
        .dropdown-item:hover {
            background: rgba(255, 255, 255, 0.1);
        }
        
        .dropdown-divider {
            height: 1px;
            background: rgba(255, 255, 255, 0.1);
            margin: 5px 0;
        }
    </style>
</head>
<body>
    <!-- Écran de connexion -->
    <div class="login-container" id="login-container">
        <div class="logo">Pay<span>Secure</span></div>
        <form class="login-form" id="login-form">
            <div class="form-group">
                <label for="username">Identifiant</label>
                <input type="text" id="username" placeholder="Votre identifiant" required>
            </div>
            <div class="form-group">
                <label for="password">Mot de passe</label>
                <input type="password" id="password" placeholder="Votre mot de passe" required>
            </div>
            <button type="submit" class="btn btn-primary">Se connecter</button>
            <div class="error-message" id="error-message">Identifiant ou mot de passe incorrect</div>
            <div class="login-options">
                <a href="#" id="forgot-password">Mot de passe oublié?</a>
                <a href="#" id="create-account">Créer un compte</a>
            </div>
        </form>
    </div>
    
    <!-- Application principale (cachée jusqu'à l'authentification) -->
    <div class="container" id="app-container">
        <header>
            <div class="logo">Pay<span>Secure</span></div>
            <div class="user-info">
                <div class="balance">Solde: <span id="balance-amount">1 250,00 €</span></div>
                <div class="user-menu">
                    <div class="avatar" id="user-avatar">JD</div>
                    <div class="dropdown-menu" id="user-menu">
                        <div class="dropdown-item" id="profile-btn">
                            <i class="fas fa-user"></i> Mon profil
                        </div>
                        <div class="dropdown-item" id="security-btn">
                            <i class="fas fa-shield-alt"></i> Sécurité
                        </div>
                        <div class="dropdown-divider"></div>
                        <div class="dropdown-item" id="logout-btn">
                            <i class="fas fa-sign-out-alt"></i> Déconnexion
                        </div>
                    </div>
                </div>
            </div>
        </header>
        
        <div class="main-content">
            <div class="card-section">
                <h2 class="section-title"><i class="fas fa-credit-card"></i> Ma Carte Virtuelle</h2>
                
                <div class="virtual-card">
                    <div class="card-chip"></div>
                    <div class="card-number" id="card-number">**** **** **** 4512</div>
                    <div class="card-details">
                        <div class="card-holder">
                            <div class="card-label">Titulaire</div>
                            <div id="card-holder">JEAN DUPONT</div>
                        </div>
                        <div class="card-expiry">
                            <div class="card-label">Expire le</div>
                            <div id="card-expiry">12/25</div>
                        </div>
                    </div>
                    <div class="card-logo">VISA</div>
                </div>
                
                <div class="card-back">
                    <div class="card-strip"></div>
                    <div class="card-details">
                        <div class="card-cvv" id="card-cvv">123</div>
                        <div class="card-logo">VISA</div>
                    </div>
                </div>
                
                <div class="actions">
                    <button class="btn btn-primary" id="show-card-details">
                        <i class="fas fa-eye"></i> Afficher les détails
                    </button>
                    <button class="btn btn-secondary" id="generate-new-card">
                        <i class="fas fa-sync-alt"></i> Nouvelle carte
                    </button>
                </div>
            </div>
            
            <div class="card-section">
                <h2 class="section-title"><i class="fas fa-bolt"></i> Actions Rapides</h2>
                
                <div class="actions">
                    <button class="btn btn-success" id="send-money-btn">
                        <i class="fas fa-paper-plane"></i> Envoyer
                    </button>
                    <button class="btn btn-primary" id="receive-money-btn">
                        <i class="fas fa-download"></i> Recevoir
                    </button>
                    <button class="btn btn-warning" id="load-card-btn">
                        <i class="fas fa-credit-card"></i> Charger carte
                    </button>
                    <button class="btn btn-mobile-money" id="mobile-money-btn">
                        <i class="fas fa-mobile-alt"></i> Mobile Money
                    </button>
                    <button class="btn btn-secondary" id="transaction-history-btn">
                        <i class="fas fa-history"></i> Historique
                    </button>
                </div>
                
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-label">Solde initial</div>
                        <div class="stat-value" id="initial-balance">1 250,00 €</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-label">Total envoyé</div>
                        <div class="stat-value negative" id="total-sent">- 450,00 €</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-label">Total reçu</div>
                        <div class="stat-value positive" id="total-received">+ 680,00 €</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-label">Solde actuel</div>
                        <div class="stat-value" id="current-balance">1 480,00 €</div>
                    </div>
                </div>
            </div>
            
            <div class="card-section">
                <h2 class="section-title"><i class="fas fa-chart-bar"></i> Statistiques</h2>
                
                <div class="stats">
                    <div class="transaction-item">
                        <div class="transaction-info">
                            <div class="transaction-icon send"><i class="fas fa-arrow-up"></i></div>
                            <div class="transaction-details">
                                <h4>Dépenses ce mois</h4>
                                <p>Total des transactions sortantes</p>
                            </div>
                        </div>
                        <div class="transaction-amount negative">- 450,00 €</div>
                    </div>
                    
                    <div class="transaction-item">
                        <div class="transaction-info">
                            <div class="transaction-icon receive"><i class="fas fa-arrow-down"></i></div>
                            <div class="transaction-details">
                                <h4>Revenus ce mois</h4>
                                <p>Total des transactions entrantes</p>
                            </div>
                        </div>
                        <div class="transaction-amount positive">+ 680,00 €</div>
                    </div>
                    
                    <div class="transaction-item">
                        <div class="transaction-info">
                            <div class="transaction-icon load"><i class="fas fa-plus-circle"></i></div>
                            <div class="transaction-details">
                                <h4>Chargements</h4>
                                <p>Total des rechargements de compte</p>
                            </div>
                        </div>
                        <div class="transaction-amount positive">+ 500,00 €</div>
                    </div>
                    
                    <div class="transaction-item">
                        <div class="transaction-info">
                            <div class="transaction-icon mobile-money"><i class="fas fa-mobile-alt"></i></div>
                            <div class="transaction-details">
                                <h4>Mobile Money</h4>
                                <p>Total des transferts Mobile Money</p>
                            </div>
                        </div>
                        <div class="transaction-amount negative">- 120,00 €</div>
                    </div>
                </div>
            </div>
            
            <div class="card-section">
                <h2 class="section-title"><i class="fas fa-clock"></i> Dernières Transactions</h2>
                
                <div class="transaction-history" id="transaction-list">
                    <!-- Les transactions seront ajoutées ici par JavaScript -->
                </div>
            </div>
        </div>
        
        <footer>
            <p>PaySecure - Système de paiement sécurisé © 2023. Tous droits réservés.</p>
        </footer>
    </div>
    
    <!-- Modal pour l'envoi d'argent -->
    <div class="modal" id="send-money-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3><i class="fas fa-paper-plane"></i> Envoyer de l'argent</h3>
                <button class="close-modal">&times;</button>
            </div>
            <div class="form-group">
                <label for="recipient">Nom du bénéficiaire</label>
                <input type="text" id="recipient" placeholder="Nom complet du bénéficiaire">
            </div>
            <div class="beneficiary-info">
                <div class="form-group">
                    <label for="beneficiary-phone">Téléphone du bénéficiaire</label>
                    <input type="tel" id="beneficiary-phone" placeholder="Numéro de téléphone">
                </div>
                <div class="form-group">
                    <label for="beneficiary-email">Email du bénéficiaire</label>
                    <input type="email" id="beneficiary-email" placeholder="Adresse email">
                </div>
            </div>
            <div class="form-group">
                <label for="send-amount">Montant</label>
                <div class="currency-converter">
                    <input type="number" id="send-amount" placeholder="0,00">
                    <select id="currency-from">
                        <option value="EUR">EUR</option>
                        <option value="USD">USD</option>
                        <option value="GBP">GBP</option>
                        <option value="JPY">JPY</option>
                        <option value="CAD">CAD</option>
                        <option value="AUD">AUD</option>
                        <option value="CHF">CHF</option>
                        <option value="CNY">CNY</option>
                        <option value="XOF">XOF</option>
                    </select>
                    <span><i class="fas fa-exchange-alt"></i></span>
                    <select id="currency-to">
                        <option value="EUR">EUR</option>
                        <option value="USD">USD</option>
                        <option value="GBP">GBP</option>
                        <option value="JPY">JPY</option>
                        <option value="CAD">CAD</option>
                        <option value="AUD">AUD</option>
                        <option value="CHF">CHF</option>
                        <option value="CNY">CNY</option>
                        <option value="XOF">XOF</option>
                    </select>
                </div>
                <div class="conversion-result" id="conversion-result">
                    <span id="conversion-text"></span>
                </div>
                <div class="fee-info" id="fee-info">
                    Frais de transfert (5%): <span id="fee-amount">0.00</span> <span id="fee-currency">EUR</span>
                </div>
                <div class="summary">
                    <div class="summary-item">
                        <span>Montant à envoyer:</span>
                        <span id="send-summary">0.00 EUR</span>
                    </div>
                    <div class="summary-item">
                        <span>Frais de transfert (5%):</span>
                        <span id="fee-summary">0.00 EUR</span>
                    </div>
                    <div class="summary-item summary-total">
                        <span>Total débité:</span>
                        <span id="total-summary">0.00 EUR</span>
                    </div>
                </div>
            </div>
            <div class="form-group">
                <label for="send-message">Message (optionnel)</label>
                <textarea id="send-message" placeholder="Raison du paiement" rows="3"></textarea>
            </div>
            <div class="auto-generate-notice">
                <i class="fas fa-info-circle"></i> Le QR Code se génère automatiquement, mais vous pouvez aussi le générer manuellement
            </div>
            <div class="qr-code-container">
                <div id="qrcode"></div>
                <div class="qr-actions">
                    <button class="btn btn-primary" id="generate-qr">
                        <i class="fas fa-qrcode"></i> Générer QR Code
                    </button>
                    <button class="btn btn-warning" id="download-qr">
                        <i class="fas fa-download"></i> Télécharger
                    </button>
                </div>
            </div>
            <div class="send-actions">
                <button class="btn btn-whatsapp" id="send-whatsapp">
                    <i class="fab fa-whatsapp"></i> Envoyer par WhatsApp
                </button>
                <button class="btn btn-success" id="confirm-send">
                    <i class="fas fa-check"></i> Confirmer l'envoi
                </button>
            </div>
        </div>
    </div>
    
    <!-- Modal pour la réception d'argent -->
    <div class="modal" id="receive-money-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3><i class="fas fa-download"></i> Recevoir de l'argent</h3>
                <button class="close-modal">&times;</button>
            </div>
            
            <div class="tabs">
                <div class="tab active" data-tab="receive">Recevoir un paiement</div>
                <div class="tab" data-tab="scan">Scanner un QR Code</div>
            </div>
            
            <div class="tab-content active" id="tab-receive">
                <div class="form-group">
                    <label>Votre adresse de paiement</label>
                    <input type="text" value="paysecure.me/jeandupont" readonly>
                </div>
                <div class="form-group">
                    <label>Code QR de paiement</label>
                    <div class="qr-code-container">
                        <div id="receive-qrcode"></div>
                    </div>
                </div>
                <button class="btn btn-primary" style="width: 100%;" id="copy-address">
                    <i class="fas fa-copy"></i> Copier l'adresse
                </button>
            </div>
            
            <div class="tab-content" id="tab-scan">
                <div class="form-group">
                    <label>Scanner un QR Code de paiement</label>
                    <div class="qr-code-container">
                        <div id="scanner-container">
                            <video id="scanner-video"></video>
                            <div class="scanner-overlay">
                                <div class="scanner-line"></div>
                            </div>
                            <div id="scanner-placeholder">
                                <i class="fas fa-qrcode" style="font-size: 60px; color: #ccc; margin-bottom: 15px;"></i>
                                <p>Scanner un QR Code de paiement</p>
                            </div>
                        </div>
                        <div class="scanner-actions">
                            <button class="btn btn-info" id="start-scanner">
                                <i class="fas fa-camera"></i> Démarrer le scanner
                            </button>
                            <button class="btn btn-secondary" id="stop-scanner" style="display: none;">
                                <i class="fas fa-stop"></i> Arrêter le scanner
                            </button>
                        </div>
                    </div>
                </div>
                <div class="form-group">
                    <label>Ou importer une image de QR Code</label>
                    <div class="file-upload">
                        <div class="file-upload-btn">
                            <i class="fas fa-upload"></i> Choisir un fichier QR Code
                        </div>
                        <input type="file" id="import-qr" accept="image/*">
                    </div>
                </div>
                
                <div class="import-result" id="import-result">
                    <div id="import-result-text"></div>
                </div>
                
                <div class="transaction-preview" id="transaction-preview">
                    <h4>Détails de la transaction</h4>
                    <div class="summary-item">
                        <span>Expéditeur:</span>
                        <span id="preview-sender">-</span>
                    </div>
                    <div class="summary-item">
                        <span>Montant:</span>
                        <span id="preview-amount">-</span>
                    </div>
                    <div class="summary-item">
                        <span>Devise:</span>
                        <span id="preview-currency">-</span>
                    </div>
                    <div class="summary-item">
                        <span>Message:</span>
                        <span id="preview-message">-</span>
                    </div>
                    <button class="btn btn-success" id="confirm-receive" style="width: 100%; margin-top: 15px;">
                        <i class="fas fa-check"></i> Confirmer la réception
                    </button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Modal pour charger la carte -->
    <div class="modal" id="load-card-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3><i class="fas fa-credit-card"></i> Charger la carte virtuelle</h3>
                <button class="close-modal">&times;</button>
            </div>
            <div class="form-group">
                <label for="load-amount">Montant à charger (€)</label>
                <input type="number" id="load-amount" placeholder="0,00">
            </div>
            <div class="form-group">
                <label for="load-method">Méthode de paiement</label>
                <select id="load-method">
                    <option value="card">Carte bancaire</option>
                    <option value="transfer">Virement bancaire</option>
                    <option value="paypal">PayPal</option>
                    <option value="crypto">Cryptomonnaie</option>
                </select>
            </div>
            
            <div id="card-details" class="form-group">
                <label for="card-number-load">Numéro de carte</label>
                <input type="text" id="card-number-load" placeholder="1234 5678 9012 3456">
                
                <div class="beneficiary-info">
                    <div class="form-group">
                        <label for="card-expiry-load">Date d'expiration</label>
                        <input type="text" id="card-expiry-load" placeholder="MM/AA">
                    </div>
                    <div class="form-group">
                        <label for="card-cvv-load">CVV</label>
                        <input type="text" id="card-cvv-load" placeholder="123">
                    </div>
                </div>
            </div>
            
            <div class="summary">
                <div class="summary-item">
                    <span>Montant à charger:</span>
                    <span id="load-summary">0.00 €</span>
                </div>
                <div class="summary-item">
                    <span>Frais de traitement (1%):</span>
                    <span id="load-fee">0.00 €</span>
                </div>
                <div class="summary-item summary-total">
                    <span>Total à payer:</span>
                    <span id="load-total">0.00 €</span>
                </div>
            </div>
            
            <div class="load-actions">
                <button class="btn btn-warning" id="cancel-load">
                    <i class="fas fa-times"></i> Annuler
                </button>
                <button class="btn btn-success" id="confirm-load">
                    <i class="fas fa-check"></i> Confirmer le chargement
                </button>
            </div>
        </div>
    </div>
    
    <!-- Modal pour Mobile Money -->
    <div class="modal" id="mobile-money-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3><i class="fas fa-mobile-alt"></i> Mobile Money</h3>
                <button class="close-modal">&times;</button>
            </div>
            
            <div class="mobile-money-options">
                <div class="mobile-money-option active" data-provider="orange">
                    <i class="fas fa-sim-card" style="font-size: 30px; color: #FF6600;"></i>
                    <div>Orange Money</div>
                </div>
                <div class="mobile-money-option" data-provider="mtn">
                    <i class="fas fa-sim-card" style="font-size: 30px; color: #FFCC00;"></i>
                    <div>MTN Mobile Money</div>
                </div>
                <div class="mobile-money-option" data-provider="wave">
                    <i class="fas fa-wave-square" style="font-size: 30px; color: #00B2FF;"></i>
                    <div>Wave</div>
                </div>
            </div>
            
            <div class="form-group">
                <label for="mobile-number">Numéro de téléphone</label>
                <input type="tel" id="mobile-number" placeholder="Ex: +225 07 08 09 10 11">
            </div>
            
            <div class="form-group">
                <label for="mobile-amount">Montant (FCFA)</label>
                <input type="number" id="mobile-amount" placeholder="0">
            </div>
            
            <div class="conversion-result">
                <span id="mobile-conversion">Équivalent: 0.00 €</span>
            </div>
            
            <div class="fee-info">
                Frais de transfert (2%): <span id="mobile-fee">0 FCFA</span>
            </div>
            
            <div class="summary">
                <div class="summary-item">
                    <span>Montant à envoyer:</span>
                    <span id="mobile-summary">0 FCFA</span>
                </div>
                <div class="summary-item">
                    <span>Frais de transfert (2%):</span>
                    <span id="mobile-fee-summary">0 FCFA</span>
                </div>
                <div class="summary-item summary-total">
                    <span>Total débité:</span>
                    <span id="mobile-total">0 FCFA</span>
                </div>
            </div>
            
            <div class="load-actions">
                <button class="btn btn-warning" id="cancel-mobile">
                    <i class="fas fa-times"></i> Annuler
                </button>
                <button class="btn btn-success" id="confirm-mobile">
                    <i class="fas fa-check"></i> Confirmer
                </button>
            </div>
        </div>
    </div>
    
    <!-- Modal pour l'historique des transactions -->
    <div class="modal" id="transaction-history-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3><i class="fas fa-history"></i> Historique des transactions</h3>
                <button class="close-modal">&times;</button>
            </div>
            
            <div class="tabs">
                <div class="tab active" data-tab="all">Toutes</div>
                <div class="tab" data-tab="sent">Envoyées</div>
                <div class="tab" data-tab="received">Reçues</div>
                <div class="tab" data-tab="load">Chargements</div>
            </div>
            
            <div class="transaction-history" id="full-transaction-list" style="max-height: 400px;">
                <!-- L'historique complet sera chargé ici -->
            </div>
            
            <div class="form-group" style="margin-top: 20px;">
                <button class="btn btn-secondary" id="export-history" style="width: 100%;">
                    <i class="fas fa-file-export"></i> Exporter l'historique (CSV)
                </button>
            </div>
        </div>
    </div>
    
    <!-- Modal pour les détails de la carte -->
    <div class="modal" id="card-details-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3><i class="fas fa-credit-card"></i> Détails de la carte</h3>
                <button class="close-modal">&times;</button>
            </div>
            
            <div class="virtual-card">
                <div class="card-chip"></div>
                <div class="card-number" id="full-card-number">4512 3456 7890 1234</div>
                <div class="card-details">
                    <div class="card-holder">
                        <div class="card-label">Titulaire</div>
                        <div>JEAN DUPONT</div>
                    </div>
                    <div class="card-expiry">
                        <div class="card-label">Expire le</div>
                        <div>12/25</div>
                    </div>
                </div>
                <div class="card-logo">VISA</div>
            </div>
            
            <div class="security-features">
                <div class="security-item">
                    <div class="security-icon"><i class="fas fa-shield-alt"></i></div>
                    <div>Verification 3D Secure</div>
                </div>
                <div class="security-item">
                    <div class="security-icon"><i class="fas fa-lock"></i></div>
                    <div>Chiffrement SSL</div>
                </div>
                <div class="security-item">
                    <div class="security-icon"><i class="fas fa-bell"></i></div>
                    <div>Alertes de transaction</div>
                </div>
                <div class="security-item">
                    <div class="security-icon"><i class="fas fa-ban"></i></div>
                    <div>Blocage instantané</div>
                </div>
            </div>
            
            <div class="actions" style="margin-top: 20px;">
                <button class="btn btn-danger" id="block-card">
                    <i class="fas fa-ban"></i> Bloquer la carte
                </button>
                <button class="btn btn-secondary" id="close-card-details">
                    <i class="fas fa-times"></i> Fermer
                </button>
            </div>
        </div>
    </div>
    
    <!-- Notification -->
    <div class="notification" id="notification">
        <i class="fas fa-check-circle"></i> <span id="notification-text">Opération réussie!</span>
    </div>

    <script>
        // Système d'authentification
        const loginContainer = document.getElementById('login-container');
        const appContainer = document.getElementById('app-container');
        const loginForm = document.getElementById('login-form');
        const errorMessage = document.getElementById('error-message');
        const logoutBtn = document.getElementById('logout-btn');
        const userAvatar = document.getElementById('user-avatar');
        const userMenu = document.getElementById('user-menu');
        
        // Base de données des utilisateurs (stockée dans le localStorage)
        function initializeUserDatabase() {
            if (!localStorage.getItem('users')) {
                const users = [
                    { id: 1, username: 'jeandupont', password: 'password123', fullName: 'Jean Dupont', balance: 1480.00 },
                    { id: 2, username: 'mariemartin', password: 'secure456', fullName: 'Marie Martin', balance: 2350.00 },
                    { id: 3, username: 'pierredurand', password: 'pass789', fullName: 'Pierre Durand', balance: 890.00 }
                ];
                localStorage.setItem('users', JSON.stringify(users));
            }
        }
        
        // Vérifier si l'utilisateur est déjà connecté
        function checkLoggedIn() {
            const currentUser = localStorage.getItem('currentUser');
            if (currentUser) {
                showApp(JSON.parse(currentUser));
            } else {
                showLogin();
            }
        }
        
        // Afficher l'écran de connexion
        function showLogin() {
            loginContainer.style.display = 'block';
            appContainer.style.display = 'none';
        }
        
        // Afficher l'application
        function showApp(user) {
            loginContainer.style.display = 'none';
            appContainer.style.display = 'block';
            
            // Mettre à jour l'interface avec les informations de l'utilisateur
            userAvatar.textContent = user.fullName.split(' ').map(n => n[0]).join('');
            document.getElementById('card-holder').textContent = user.fullName.toUpperCase();
            document.getElementById('balance-amount').textContent = `${user.balance.toFixed(2)} €`;
            document.getElementById('current-balance').textContent = `${user.balance.toFixed(2)} €`;
            
            // Mettre à jour le solde dans les données
            balance = user.balance;
            updateBalance();
        }
        
        // Gérer la connexion
        loginForm.addEventListener('submit', function(e) {
            e.preventDefault();
            
            const username = document.getElementById('username').value;
            const password = document.getElementById('password').value;
            
            const users = JSON.parse(localStorage.getItem('users'));
            const user = users.find(u => u.username === username && u.password === password);
            
            if (user) {
                // Connexion réussie
                localStorage.setItem('currentUser', JSON.stringify(user));
                showApp(user);
                errorMessage.style.display = 'none';
            } else {
                // Échec de la connexion
                errorMessage.style.display = 'block';
            }
        });
        
        // Gérer la déconnexion
        logoutBtn.addEventListener('click', function() {
            localStorage.removeItem('currentUser');
            showLogin();
        });
        
        // Gérer le menu utilisateur
        userAvatar.addEventListener('click', function() {
            userMenu.style.display = userMenu.style.display === 'block' ? 'none' : 'block';
        });
        
        // Fermer le menu utilisateur en cliquant ailleurs
        document.addEventListener('click', function(e) {
            if (!userAvatar.contains(e.target) && !userMenu.contains(e.target)) {
                userMenu.style.display = 'none';
            }
        });
        
        // Initialiser la base de données et vérifier l'état de connexion au chargement
        window.addEventListener('load', function() {
            initializeUserDatabase();
            checkLoggedIn();
        });
        
        // Données initiales
        let balance = 1480.00;
        let transactions = [
            {
                id: 1,
                type: 'sent',
                amount: -150.00,
                currency: 'EUR',
                recipient: 'Marie Martin',
                date: '2023-10-15',
                time: '14:30',
                status: 'completed'
            },
            {
                id: 2,
                type: 'received',
                amount: 200.00,
                currency: 'EUR',
                sender: 'Pierre Durand',
                date: '2023-10-14',
                time: '09:15',
                status: 'completed'
            },
            {
                id: 3,
                type: 'load',
                amount: 500.00,
                currency: 'EUR',
                method: 'Carte bancaire',
                date: '2023-10-10',
                time: '16:45',
                status: 'completed'
            },
            {
                id: 4,
                type: 'mobile',
                amount: -50.00,
                currency: 'XOF',
                recipient: '+225 07 12 34 56 78',
                provider: 'Orange Money',
                date: '2023-10-08',
                time: '11:20',
                status: 'completed'
            },
            {
                id: 5,
                type: 'sent',
                amount: -300.00,
                currency: 'EUR',
                recipient: 'Sophie Lambert',
                date: '2023-10-05',
                time: '18:05',
                status: 'completed'
            }
        ];

        // Éléments DOM
        const balanceAmount = document.getElementById('balance-amount');
        const transactionList = document.getElementById('transaction-list');
        const fullTransactionList = document.getElementById('full-transaction-list');
        
        // Modals
        const modals = document.querySelectorAll('.modal');
        const sendMoneyModal = document.getElementById('send-money-modal');
        const receiveMoneyModal = document.getElementById('receive-money-modal');
        const loadCardModal = document.getElementById('load-card-modal');
        const mobileMoneyModal = document.getElementById('mobile-money-modal');
        const transactionHistoryModal = document.getElementById('transaction-history-modal');
        const cardDetailsModal = document.getElementById('card-details-modal');
        
        // Boutons d'ouverture de modals
        document.getElementById('send-money-btn').addEventListener('click', () => openModal(sendMoneyModal));
        document.getElementById('receive-money-btn').addEventListener('click', () => openModal(receiveMoneyModal));
        document.getElementById('load-card-btn').addEventListener('click', () => openModal(loadCardModal));
        document.getElementById('mobile-money-btn').addEventListener('click', () => openModal(mobileMoneyModal));
        document.getElementById('transaction-history-btn').addEventListener('click', () => {
            openModal(transactionHistoryModal);
            loadFullTransactionHistory();
        });
        document.getElementById('show-card-details').addEventListener('click', () => openModal(cardDetailsModal));
        
        // Boutons de fermeture de modals
        document.querySelectorAll('.close-modal').forEach(button => {
            button.addEventListener('click', () => closeModals());
        });

        // Fermer les modals en cliquant à l'extérieur
        modals.forEach(modal => {
            modal.addEventListener('click', (e) => {
                if (e.target === modal) {
                    closeModals();
                }
            });
        });

        // Fonctions pour gérer les modals
        function openModal(modal) {
            closeModals();
            modal.style.display = 'flex';
        }

        function closeModals() {
            modals.forEach(modal => {
                modal.style.display = 'none';
            });
        }

        // Gestion des onglets
        document.querySelectorAll('.tab').forEach(tab => {
            tab.addEventListener('click', () => {
                const tabId = tab.getAttribute('data-tab');
                const tabContent = document.getElementById(`tab-${tabId}`);
                
                // Désactiver tous les onglets
                document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
                document.querySelectorAll('.tab-content').forEach(tc => tc.classList.remove('active'));
                
                // Activer l'onglet sélectionné
                tab.classList.add('active');
                tabContent.classList.add('active');
            });
        });

        // Mise à jour de l'interface
        function updateBalance() {
            balanceAmount.textContent = `${balance.toFixed(2)} €`;
            document.getElementById('current-balance').textContent = `${balance.toFixed(2)} €`;
            
            // Mettre à jour le solde de l'utilisateur dans le localStorage
            const currentUser = JSON.parse(localStorage.getItem('currentUser'));
            if (currentUser) {
                currentUser.balance = balance;
                localStorage.setItem('currentUser', JSON.stringify(currentUser));
                
                // Mettre à jour également dans la base de données des utilisateurs
                const users = JSON.parse(localStorage.getItem('users'));
                const userIndex = users.findIndex(u => u.id === currentUser.id);
                if (userIndex !== -1) {
                    users[userIndex].balance = balance;
                    localStorage.setItem('users', JSON.stringify(users));
                }
            }
        }

        function loadTransactionHistory() {
            transactionList.innerHTML = '';
            const recentTransactions = transactions.slice(0, 5);
            
            recentTransactions.forEach(transaction => {
                const transactionItem = document.createElement('div');
                transactionItem.className = 'transaction-item';
                
                let iconClass = '';
                let icon = '';
                let description = '';
                
                switch(transaction.type) {
                    case 'sent':
                        iconClass = 'send';
                        icon = 'fa-arrow-up';
                        description = `À ${transaction.recipient}`;
                        break;
                    case 'received':
                        iconClass = 'receive';
                        icon = 'fa-arrow-down';
                        description = `De ${transaction.sender}`;
                        break;
                    case 'load':
                        iconClass = 'load';
                        icon = 'fa-plus-circle';
                        description = `Rechargement ${transaction.method}`;
                        break;
                    case 'mobile':
                        iconClass = 'mobile-money';
                        icon = 'fa-mobile-alt';
                        description = `Mobile Money ${transaction.provider}`;
                        break;
                }
                
                transactionItem.innerHTML = `
                    <div class="transaction-info">
                        <div class="transaction-icon ${iconClass}"><i class="fas ${icon}"></i></div>
                        <div class="transaction-details">
                            <h4>${transaction.type === 'sent' ? 'Envoi' : transaction.type === 'received' ? 'Réception' : transaction.type === 'load' ? 'Rechargement' : 'Mobile Money'}</h4>
                            <p>${description} • ${transaction.date} ${transaction.time}</p>
                        </div>
                    </div>
                    <div class="transaction-amount ${transaction.amount < 0 ? 'negative' : 'positive'}">
                        ${transaction.amount > 0 ? '+' : ''}${transaction.amount.toFixed(2)} ${transaction.currency}
                    </div>
                `;
                
                transactionList.appendChild(transactionItem);
            });
        }

        function loadFullTransactionHistory() {
            fullTransactionList.innerHTML = '';
            
            transactions.forEach(transaction => {
                const transactionItem = document.createElement('div');
                transactionItem.className = 'transaction-item';
                
                let iconClass = '';
                let icon = '';
                let description = '';
                
                switch(transaction.type) {
                    case 'sent':
                        iconClass = 'send';
                        icon = 'fa-arrow-up';
                        description = `À ${transaction.recipient}`;
                        break;
                    case 'received':
                        iconClass = 'receive';
                        icon = 'fa-arrow-down';
                        description = `De ${transaction.sender}`;
                        break;
                    case 'load':
                        iconClass = 'load';
                        icon = 'fa-plus-circle';
                        description = `Rechargement ${transaction.method}`;
                        break;
                    case 'mobile':
                        iconClass = 'mobile-money';
                        icon = 'fa-mobile-alt';
                        description = `Mobile Money ${transaction.provider}`;
                        break;
                }
                
                transactionItem.innerHTML = `
                    <div class="transaction-info">
                        <div class="transaction-icon ${iconClass}"><i class="fas ${icon}"></i></div>
                        <div class="transaction-details">
                            <h4>${transaction.type === 'sent' ? 'Envoi' : transaction.type === 'received' ? 'Réception' : transaction.type === 'load' ? 'Rechargement' : 'Mobile Money'}</h4>
                            <p>${description} • ${transaction.date} ${transaction.time}</p>
                        </div>
                    </div>
                    <div class="transaction-amount ${transaction.amount < 0 ? 'negative' : 'positive'}">
                        ${transaction.amount > 0 ? '+' : ''}${transaction.amount.toFixed(2)} ${transaction.currency}
                    </div>
                `;
                
                fullTransactionList.appendChild(transactionItem);
            });
        }

        // Gestion de l'envoi d'argent
        document.getElementById('send-amount').addEventListener('input', updateSendSummary);
        document.getElementById('currency-from').addEventListener('change', updateSendSummary);
        document.getElementById('currency-to').addEventListener('change', updateSendSummary);

        function updateSendSummary() {
            const amount = parseFloat(document.getElementById('send-amount').value) || 0;
            const currencyFrom = document.getElementById('currency-from').value;
            const currencyTo = document.getElementById('currency-to').value;
            
            // Simulation de taux de change
            const exchangeRates = {
                'EUR': { 'USD': 1.07, 'GBP': 0.86, 'JPY': 157.50, 'CAD': 1.46, 'AUD': 1.65, 'CHF': 0.95, 'CNY': 7.80, 'XOF': 655.96 },
                'USD': { 'EUR': 0.93, 'GBP': 0.80, 'JPY': 147.20, 'CAD': 1.36, 'AUD': 1.54, 'CHF': 0.89, 'CNY': 7.30, 'XOF': 613.00 },
                'GBP': { 'EUR': 1.16, 'USD': 1.25, 'JPY': 183.90, 'CAD': 1.70, 'AUD': 1.92, 'CHF': 1.10, 'CNY': 9.05, 'XOF': 762.00 },
                'XOF': { 'EUR': 0.00152, 'USD': 0.00163, 'GBP': 0.00131, 'JPY': 0.24, 'CAD': 0.00222, 'AUD': 0.00251, 'CHF': 0.00145, 'CNY': 0.0119 }
            };
            
            let convertedAmount = amount;
            if (currencyFrom !== currencyTo && exchangeRates[currencyFrom] && exchangeRates[currencyFrom][currencyTo]) {
                convertedAmount = amount * exchangeRates[currencyFrom][currencyTo];
            }
            
            const fee = convertedAmount * 0.05; // Frais de 5%
            const total = convertedAmount + fee;
            
            document.getElementById('conversion-text').textContent = 
                `${amount.toFixed(2)} ${currencyFrom} = ${convertedAmount.toFixed(2)} ${currencyTo}`;
            document.getElementById('conversion-result').style.display = 'block';
            
            document.getElementById('fee-amount').textContent = fee.toFixed(2);
            document.getElementById('fee-currency').textContent = currencyTo;
            
            document.getElementById('send-summary').textContent = `${convertedAmount.toFixed(2)} ${currencyTo}`;
            document.getElementById('fee-summary').textContent = `${fee.toFixed(2)} ${currencyTo}`;
            document.getElementById('total-summary').textContent = `${total.toFixed(2)} ${currencyTo}`;
        }

        // Gestion du chargement de la carte
        document.getElementById('load-amount').addEventListener('input', updateLoadSummary);

        function updateLoadSummary() {
            const amount = parseFloat(document.getElementById('load-amount').value) || 0;
            const fee = amount * 0.01; // Frais de 1%
            const total = amount + fee;
            
            document.getElementById('load-summary').textContent = `${amount.toFixed(2)} €`;
            document.getElementById('load-fee').textContent = `${fee.toFixed(2)} €`;
            document.getElementById('load-total').textContent = `${total.toFixed(2)} €`;
        }

        // Gestion du Mobile Money
        document.getElementById('mobile-amount').addEventListener('input', updateMobileSummary);
        document.querySelectorAll('.mobile-money-option').forEach(option => {
            option.addEventListener('click', function() {
                document.querySelectorAll('.mobile-money-option').forEach(opt => opt.classList.remove('active'));
                this.classList.add('active');
            });
        });

        function updateMobileSummary() {
            const amount = parseFloat(document.getElementById('mobile-amount').value) || 0;
            const euroAmount = amount * 0.00152; // Conversion XOF vers EUR
            const fee = amount * 0.02; // Frais de 2%
            const total = amount + fee;
            
            document.getElementById('mobile-conversion').textContent = `Équivalent: ${euroAmount.toFixed(2)} €`;
            document.getElementById('mobile-fee').textContent = `${fee.toFixed(2)} FCFA`;
            
            document.getElementById('mobile-summary').textContent = `${amount.toFixed(2)} FCFA`;
            document.getElementById('mobile-fee-summary').textContent = `${fee.toFixed(2)} FCFA`;
            document.getElementById('mobile-total').textContent = `${total.toFixed(2)} FCFA`;
        }

        // Génération de QR Code pour l'envoi
        document.getElementById('generate-qr').addEventListener('click', function() {
            const amount = document.getElementById('send-amount').value;
            const currency = document.getElementById('currency-to').value;
            const recipient = document.getElementById('recipient').value;
            
            if (!amount || !recipient) {
                showNotification('Veuillez remplir le montant et le bénéficiaire', 'error');
                return;
            }
            
            const qrData = JSON.stringify({
                type: 'payment',
                amount: amount,
                currency: currency,
                recipient: recipient,
                timestamp: new Date().toISOString()
            });
            
            const qrcodeElement = document.getElementById('qrcode');
            qrcodeElement.innerHTML = '';
            
            QRCode.toCanvas(qrcodeElement, qrData, function(error) {
                if (error) {
                    console.error(error);
                    showNotification('Erreur lors de la génération du QR Code', 'error');
                } else {
                    showNotification('QR Code généré avec succès', 'success');
                }
            });
        });

        // Génération de QR Code pour la réception
        window.addEventListener('load', function() {
            const qrData = JSON.stringify({
                type: 'receive',
                address: 'paysecure.me/jeandupont',
                currency: 'EUR',
                timestamp: new Date().toISOString()
            });
            
            const qrcodeElement = document.getElementById('receive-qrcode');
            qrcodeElement.innerHTML = '';
            
            QRCode.toCanvas(qrcodeElement, qrData, function(error) {
                if (error) console.error(error);
            });
        });

        // Scanner de QR Code
        let scannerActive = false;
        let videoStream = null;

        document.getElementById('start-scanner').addEventListener('click', startScanner);
        document.getElementById('stop-scanner').addEventListener('click', stopScanner);

        function startScanner() {
            const video = document.getElementById('scanner-video');
            const placeholder = document.getElementById('scanner-placeholder');
            const startBtn = document.getElementById('start-scanner');
            const stopBtn = document.getElementById('stop-scanner');
            
            navigator.mediaDevices.getUserMedia({ video: { facingMode: "environment" } })
            .then(function(stream) {
                videoStream = stream;
                video.srcObject = stream;
                video.play();
                video.style.display = 'block';
                placeholder.style.display = 'none';
                startBtn.style.display = 'none';
                stopBtn.style.display = 'block';
                scannerActive = true;
                
                scanQRCode(video);
            })
            .catch(function(err) {
                console.error("Erreur d'accès à la caméra: ", err);
                showNotification('Impossible d\'accéder à la caméra', 'error');
            });
        }

        function stopScanner() {
            if (videoStream) {
                videoStream.getTracks().forEach(track => track.stop());
                videoStream = null;
            }
            
            const video = document.getElementById('scanner-video');
            const placeholder = document.getElementById('scanner-placeholder');
            const startBtn = document.getElementById('start-scanner');
            const stopBtn = document.getElementById('stop-scanner');
            
            video.style.display = 'none';
            placeholder.style.display = 'block';
            startBtn.style.display = 'block';
            stopBtn.style.display = 'none';
            scannerActive = false;
        }

        function scanQRCode(video) {
            const canvas = document.createElement('canvas');
            const context = canvas.getContext('2d');
            
            function tick() {
                if (!scannerActive) return;
                
                if (video.readyState === video.HAVE_ENOUGH_DATA) {
                    canvas.width = video.videoWidth;
                    canvas.height = video.videoHeight;
                    context.drawImage(video, 0, 0, canvas.width, canvas.height);
                    
                    const imageData = context.getImageData(0, 0, canvas.width, canvas.height);
                    const code = jsQR(imageData.data, imageData.width, imageData.height);
                    
                    if (code) {
                        try {
                            const qrData = JSON.parse(code.data);
                            processScannedQR(qrData);
                            stopScanner();
                        } catch (e) {
                            console.error('QR Code invalide', e);
                        }
                    }
                }
                
                requestAnimationFrame(tick);
            }
            
            tick();
        }

        function processScannedQR(qrData) {
            const preview = document.getElementById('transaction-preview');
            const result = document.getElementById('import-result');
            
            if (qrData.type === 'payment') {
                document.getElementById('preview-sender').textContent = qrData.recipient || 'Inconnu';
                document.getElementById('preview-amount').textContent = `${qrData.amount} ${qrData.currency}`;
                document.getElementById('preview-currency').textContent = qrData.currency;
                document.getElementById('preview-message').textContent = qrData.message || 'Aucun message';
                
                preview.style.display = 'block';
                result.className = 'import-result success';
                result.innerHTML = '<i class="fas fa-check"></i> QR Code scanné avec succès';
                result.style.display = 'block';
            } else {
                result.className = 'import-result error';
                result.innerHTML = '<i class="fas fa-exclamation-triangle"></i> Type de QR Code non reconnu';
                result.style.display = 'block';
            }
        }

        // Gestion de l'import de QR Code
        document.getElementById('import-qr').addEventListener('change', function(e) {
            const file = e.target.files[0];
            if (!file) return;
            
            const reader = new FileReader();
            reader.onload = function(event) {
                const img = new Image();
                img.onload = function() {
                    const canvas = document.createElement('canvas');
                    const context = canvas.getContext('2d');
                    canvas.width = img.width;
                    canvas.height = img.height;
                    context.drawImage(img, 0, 0);
                    
                    const imageData = context.getImageData(0, 0, canvas.width, canvas.height);
                    const code = jsQR(imageData.data, imageData.width, imageData.height);
                    
                    const result = document.getElementById('import-result');
                    
                    if (code) {
                        try {
                            const qrData = JSON.parse(code.data);
                            processScannedQR(qrData);
                        } catch (e) {
                            result.className = 'import-result error';
                            result.innerHTML = '<i class="fas fa-exclamation-triangle"></i> QR Code invalide';
                            result.style.display = 'block';
                        }
                    } else {
                        result.className = 'import-result error';
                        result.innerHTML = '<i class="fas fa-exclamation-triangle"></i> Aucun QR Code détecté';
                        result.style.display = 'block';
                    }
                };
                img.src = event.target.result;
            };
            reader.readAsDataURL(file);
        });

        // Confirmation des transactions
        document.getElementById('confirm-send').addEventListener('click', function() {
            const amount = parseFloat(document.getElementById('send-amount').value);
            const recipient = document.getElementById('recipient').value;
            
            if (!amount || !recipient) {
                showNotification('Veuillez remplir tous les champs obligatoires', 'error');
                return;
            }
            
            if (amount > balance) {
                showNotification('Solde insuffisant', 'error');
                return;
            }
            
            balance -= amount;
            updateBalance();
            
            transactions.unshift({
                id: transactions.length + 1,
                type: 'sent',
                amount: -amount,
                currency: 'EUR',
                recipient: recipient,
                date: new Date().toISOString().split('T')[0],
                time: new Date().toLocaleTimeString('fr-FR', { hour: '2-digit', minute: '2-digit' }),
                status: 'completed'
            });
            
            loadTransactionHistory();
            closeModals();
            showNotification(`Paiement de ${amount}€ envoyé à ${recipient}`, 'success');
        });

        document.getElementById('confirm-load').addEventListener('click', function() {
            const amount = parseFloat(document.getElementById('load-amount').value);
            
            if (!amount || amount <= 0) {
                showNotification('Veuillez entrer un montant valide', 'error');
                return;
            }
            
            balance += amount;
            updateBalance();
            
            transactions.unshift({
                id: transactions.length + 1,
                type: 'load',
                amount: amount,
                currency: 'EUR',
                method: document.getElementById('load-method').value,
                date: new Date().toISOString().split('T')[0],
                time: new Date().toLocaleTimeString('fr-FR', { hour: '2-digit', minute: '2-digit' }),
                status: 'completed'
            });
            
            loadTransactionHistory();
            closeModals();
            showNotification(`Carte rechargée de ${amount}€`, 'success');
        });

        // Fonction de notification
        function showNotification(message, type = 'success') {
            const notification = document.getElementById('notification');
            const notificationText = document.getElementById('notification-text');
            
            notificationText.textContent = message;
            notification.style.background = type === 'success' ? 'var(--success)' : 'var(--danger)';
            notification.style.display = 'block';
            
            setTimeout(() => {
                notification.style.display = 'none';
            }, 3000);
        }

        // Initialisation
        updateBalance();
        loadTransactionHistory();
        
        // Gestion de la génération de nouvelle carte
        document.getElementById('generate-new-card').addEventListener('click', function() {
            document.getElementById('card-number').textContent = '**** **** **** ' + Math.floor(1000 + Math.random() * 9000);
            document.getElementById('card-cvv').textContent = Math.floor(100 + Math.random() * 900);
            document.getElementById('card-expiry').textContent = 
                `${String(Math.floor(Math.random() * 12) + 1).padStart(2, '0')}/${Math.floor(Math.random() * 5) + 24}`;
            
            showNotification('Nouvelle carte virtuelle générée', 'success');
        });

        // Copie d'adresse
        document.getElementById('copy-address').addEventListener('click', function() {
            navigator.clipboard.writeText('paysecure.me/jeandupont')
                .then(() => showNotification('Adresse copiée dans le presse-papier', 'success'))
                .catch(() => showNotification('Erreur lors de la copie', 'error'));
        });

        // Export de l'historique
        document.getElementById('export-history').addEventListener('click', function() {
            const csvContent = "data:text/csv;charset=utf-8," 
                + "ID,Type,Montant,Devise,Description,Date,Heure,Statut\n"
                + transactions.map(t => 
                    `${t.id},${t.type},${t.amount},${t.currency},${t.recipient || t.sender || t.method || ''},${t.date},${t.time},${t.status}`
                ).join("\n");
            
            const encodedUri = encodeURI(csvContent);
            const link = document.createElement("a");
            link.setAttribute("href", encodedUri);
            link.setAttribute("download", "historique_transactions.csv");
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            
            showNotification('Historique exporté en CSV', 'success');
        });
    </script>
</body>
</html>
